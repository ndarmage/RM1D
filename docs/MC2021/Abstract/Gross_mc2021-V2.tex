%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  This is a sample LaTeX input file for your contribution to 
%  the M&C2021 topical meeting.
%
%  Please use it as a template for your full paper 
%    Accompanying/related file(s) include: 
%       1. Document class/format file: mc2021.cls
%       2. Sample PDF/Postscript Figure: figure.pdf,figure.ps
%       3. A PDF file showing the desired appearance: mc2021_template.pdf
%       4. cites.sty and citesort.sty that might be needed by some users 
%    Direct questions about these files to: brantley1@llnl.gov
%
%    Notes: 
%      (1) You can use the "dvips" utility to convert .dvi 
%          files to PostScript.  Then, use either Acrobat 
%          Distiller or "ps2pdf" to convert to PDF format. 
%      (2) Different versions of LaTeX have been observed to 
%          shift the page down, causing improper margins.
%          If this occurs, adjust the "topmargin" value in the
%          mc2021.cls file to achieve the proper margins. 
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[letterpaper]{mc2021}
%
%  various packages that you may wish to activate for usage 
\usepackage{tabls}
\usepackage{cites}
\usepackage{epsf}
\usepackage{appendix}
\usepackage{ragged2e}
\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage{enumitem}
\setlist[itemize]{leftmargin=*}
\usepackage{caption}
\captionsetup{width=1.0\textwidth,font={bf,normalsize},skip=0.3cm,within=none,justification=centering}
\usepackage{bm}
\usepackage{xfrac}
\usepackage{multirow}

%\usepackage[justification=centering]{caption}

%
% Define title...
%
\title{COMPREHENSIVE BENCHMARK OF THE RONEN METHOD\\IN ONE-DIMENSIONAL PLAIN GEOMETRY}
%
% ...and authors
%
\author{%
  % FIRST AUTHORS 
  %
  \textbf{Roy Gross$^1$, Daniele Tomatis$^2$, and Erez Gilad$^1$}\footnote{Corresponding author: Erez Gilad (gilade@bgu.ac.il)} \\
  $^1$The Unit of Nuclear Engineering, Ben-Gurion University of the Negev\\ Beer-Sheva 8410501, Israel\\
\\
  $^2$DES, Service d'{\'e}tudes des r\'eacteurs et de math\'ematiques appliqu\'ees (SERMA)\\
  CEA, Universit\'e Paris-Saclay, F-91191 Gif-sur-Yvette, France\\ 
\\
  \url{roygros@post.bgu.ac.il}, \url{daniele.tomatis@cea.fr}, \url{gilade@bgu.ac.il}
}
%
% Insert authors' names and short version of title in lines below
%
\newcommand{\authorHead}{Roy Gross, Daniele Tomatis, Erez Gilad}
\newcommand{\shortTitle}{Comprehensive benchmark of the Ronen Method}

\newcommand{\tsup}[1]{\textsuperscript{#1}}
\newcommand{\tsub}[1]{\textsubscript{#1}}
\newcommand{\rr}{\bm{r}}
\newcommand{\rE}{\ensuremath{(\rr,E)}}
\newcommand{\bnabla}{\ensuremath{\bm{\nabla}}}
\newcommand{\hzi}{\ensuremath{\sfrac{1}{2}}}
\newcommand{\jD}{\ensuremath{J^{\textrm{\scriptsize{D}}}}}
\newcommand{\jp}{\ensuremath{J^+}}
\newcommand{\jm}{\ensuremath{J^-}}
\newcommand{\keff}{\ensuremath{k_{\textrm{\scriptsize{eff}}}}}

\newcommand{\kref}{\ensuremath{k_{\textrm{\scriptsize{ref}}}}}
\newcommand{\kd}{\ensuremath{k_{\textrm{\scriptsize{D}}}}}
\newcommand{\krm}{\ensuremath{k_{\textrm{\scriptsize{RM}}}}}
\newcommand{\kinf}{\ensuremath{k_{\textrm{\scriptsize{$\infty$}}}}}
\newcommand{\rcref}{\ensuremath{r_{\textrm{\scriptsize{c,ref}}}}}
\newcommand{\rc}{\ensuremath{r_{\textrm{\scriptsize{c}}}}}
\newcommand{\phiref}{\ensuremath{\phi_{\textrm{\scriptsize{ref}}}}}
\newcommand{\phirm}{\ensuremath{\phi_{\textrm{\scriptsize{RM}}}}}

\graphicspath{ {./figures/} }
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%   BEGIN DOCUMENT
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
\maketitle
\justify 

\vspace{-4.5mm}

\begin{abstract}
A comprehensive benchmark is performed for the CMFD and pCMFD implementations of the Ronen method in one-dimensional slab geometry. The CMFD/pCMFD implementations are validated against analytic solutions of homogeneous and heterogeneous configurations using one, two, and three energy groups. The validation is performed for the criticality eigenvalue and, in some cases, also for the spatial distribution of the neutron flux. The scattering is assumed to be isotropic in all cases. The results indicate that the CMFD/pCMFD implementations of the Ronen method achieve high accuracy in this set of problems. The maximal deviation in criticality is less than 20 pcm, and the maximal deviation in the spatial distribution of the flux is less than 2\% and is located on the boundary.  
\end{abstract}
\keywords{Ronen method; Integral transport, CMFD, pCMPFD; Neutron diffusion}

\section{INTRODUCTION} 
\label{sec:intro}

Full core neutron transport calculations are a demanding task, and often faster multigroup neutron diffusion solvers are used. However, the diffusion approximation is invalidated near strong absorbing materials, interfaces, and boundaries, where strong gradients appear or in case anisotropic scattering is pronounced. 

\vspace{-1.5mm}

The Ronen method (RM) is designed to overcome the inaccuracies of the diffusion approximation by correcting the diffusion currents, using the integral transport theory~\cite{Tomatis-2011,Gross-2020,Tomatis-2020}. The underlying hypothesis of the RM is the modification of the current calculated by the diffusion solver in order to reproduce the one obtained by an integral transport operator, which is assumed to be more accurate. This implies an iterative scheme since the more accurate current is determined with the solution of the diffusion calculation.

\vspace{-1.5mm}

Originally, Ronen suggested to update the diffusion coefficient as ($k$ is the iteration index)~\cite{Ronen-2004}
\begin{equation}\label{eq:RM-it}
	D^{(k+1)}(x,E) = -\frac{\displaystyle \frac{1}{2}\int_0^a dx' E_2[\sigma(E)\lvert
		x-x'\rvert]\operatorname{Sgn}(x-x')q^{(k)}(x',E)}
	{\partial \phi^{(k)}(x,E)/\partial x}.
%\label{eq:RM-it}
%D^{(k+1)}\rE = \left. - \lvert \bm{J}^{(k)}\rE \rvert \middle/ \lvert \bnabla \phi^{(k)}\rE \rvert. \right.
\end{equation}

\vspace{-10.5mm}

Later, the RM was implemented in the diffusion solver using the Coarse Mesh Finite Difference (CMFD) scheme, thus employing correction factors for the leakage terms in the discretized form of the balance equation~\cite{Tomatis-2011,Gross-2020}. Basically, a correction to the current approximated by Fick's law, $\bm{J}^D$, was introduced,
\begin{align}
\label{eq:Fick}
& \bm{J}\rE = \bm{J}^D\rE + \delta\bm{J}\rE \\ 
& \bm{J}^D\rE = -D\rE\bnabla\phi\rE,
\end{align}
with $\delta\bm{J}$ determined through the integral transport operator.  This implementation eliminated the divergence problem in Eq.~\eqref{eq:RM-it} for small flux gradients and accurately reproduced the criticality eigenvalue and the associated eigenflux calculated by a reference discrete-ordinates code.

\vspace{-1.5mm}

In this study, the RM is implemented using a variant of the CMFD method, i.e., the partial-currents CMFD (pCMFD)~\cite{Cho-2003}. In a sense, the pCMFD is a more natural choice for the RM, since the implementation of pCMFD can be naturally formulated in terms of partial currents. The performances of both implementations, CMFD and pCMFD, are thoroughly evaluated against analytic benchmarks for the criticality eigenvalue and the spatial distribution of the associated critical eigenflux~\cite{Sood2003}.    

\section{NUMERICAL IMPLEMENTATION OF THE RONEN METHOD} 
\label{sec:num-imp}

The neutron balance in the $i$\tsup{th} cell of a one-dimensional mesh is
\begin{equation}
\label{eq:balance}
J_{i+\hzi,g} - J_{i-\hzi,g} + \sigma_{i,g} \phi_{i,g} = q_{i,g} \quad \forall i,g,
\end{equation}
where $J$ is the net current at the cell's interfaces, $\sigma$ is the total cross-section, and the subscript $g$ denotes the energy group. The isotropic (scattering and fission) source term is denoted by $q$.

\vspace{-1.5mm}

\subsection{Formulation of the CMFD Scheme} 
\label{sec:cmfd}

In order to obtain a more accurate net current $J_{i+\hzi,g}$, a correction term $\delta J_{i+\hzi,g}$ is added to the diffusion-approximated current $\jD_{i+\hzi,g}$, which is is evaluated by a discretization of Fick's law, 
\begin{equation}
\label{eq:JD}
\jD_{i+\hzi,g} \cong - D_{i+\hzi,g}
\frac{\phi_{i+1,g} - \phi_{i,g}}{(\Delta_{i+1} + \Delta_i)/2},
\,\, \text{where }
%D_{i+\hzi,g} = \left\{\begin{array}{ll}
%	-J_{i+\hzi,g} \frac{(\Delta_{i+1} + \Delta_i)/2}{\phi_{i+1,g} - \phi_{i,g}}, & \text{for } J_{i+\hzi,g} \ne 0\\
%	0, & \text{otherwise}
%\end{array}\right.
D_{i+\hzi,g} = \frac{\Delta_i D_{i,g} + \Delta_{i+1} D_{i+1,g}}
{\Delta_i + \Delta_{i+1}}.
\end{equation}

\vspace{-2.5mm}

The integral expression for the net current is evaluated by using the scalar flux in the emission source to obtain a more accurate estimation of the net current. In the RM implementation, the correction terms $\delta J$ are obtained  iteratively as the difference between the net current $J$ and the diffusion-approximated current $\jD$, 
\begin{equation}
\label{eq:dJ}
\delta J_{i+\hzi,g} = -\delta D_{i+\hzi,g}
\frac{\phi_{i+1,g} + \phi_{i,g}}{(\Delta_{i+1} + \Delta_i)/2} =
J_{i+\hzi,g} - \jD_{i+\hzi,g},
\end{equation}
where discretized form of the correction term $\delta J_{i+\hzi,g}$ is the centered drift-advection term to avoid divergence due to small flux gradients~\cite{Tomatis-2011,Smith-1983}.

\vspace{-2.5mm}

\subsection{Formulation of the pCMFD Scheme} 
\label{sec:pcmfd}

In the pCMFD implementation~\cite{Cho-2003}, two correction terms are introduced per interface, consistent with the partition of the net current into two partial ones, i.e., $J = \jp - \jm = \jD + \delta J^+ + \delta J^-$, defined by $\delta \jp _{i+\hzi} = -\delta D^+ _{i+\hzi} \phi_i$ and $\delta \jm _{i+\hzi} = -\delta D^- _{i+\hzi} \phi_{i+1}$~\cite{Jarrett-2016,Zhu-2016}. These correction terms are then obtained by equally distributing the diffusion-approximated current on the partial currents,
\begin{equation}
\label{eq:delta-D-pCMFD}
\pm \delta D^{\pm} _{i+\hzi} \phi_{i+(1\mp 1)/2} = 
- J^\pm_{i+\hzi} \pm \frac{1}{2}\jD_{i+\hzi} .
\end{equation}

\vspace{-6.5mm}
%
%\begin{figure}[!htb]
%  \centering
%  \includegraphics[scale=0.46]{./Figures/MCD-poster-2016}
%  \caption{The Mathematics and Computation Division of the American Nuclear Society}
%  \label{fig:mcd}
%\end{figure}

\section{RESULTS}

The analytic benchmark of Sood et al. (2003)~\cite{Sood2003} presents one-dimensional homogeneous and heterogeneous critical configurations, including the associated one-, two-, and three-group cross-sections. For some problems, the spatial distribution of the flux is given at specific points. 
%
The deviations between the criticality eigenvalues, calculated using the CMFD and pCMFD implementations of the RM ($\krm$, and $\kd$ for pure diffusion), and the reference eigenvalue ($\kref=1$) are shown in Table~\ref{table:res1} for a selected set of problems. The deviations are shown in both units of reactivity ($\Delta\rho =  (\kref^{-1}-k^{-1})\times 10^5$ [pcm]), and in relative error in the critical width ($\Delta L =  (L_c-L_{c,\text{ref}}) / L_{c,\text{ref}}$ [\%]), where $L_c$ is the critical dimension, i.e., the distance from the fuel's center to one of the boundaries. The number of cells in the water region is half of that in the fuel region (where applied).
%
The deviations between the CMFD normalized flux and the reference analytic solutions,  $\Delta\phi = (\phirm - \phiref)/\phiref$ [\%], are shown in Table~\ref{table:res2} for a selected set of problems at positions $L_i$. 
%
\begin{table}[hbt]
	\vspace{-7.5mm}	
	\centering
	\caption{\bf Deviations of the eigenvalues \keff \ calculated by the RM from criticality.}
	\label{table:res1} 
	\small
\begin{tabular}{|l|l|c|c|c|c|c|c|} \hline 
	\multirow{2}{*}{Problem ID} & \multirow{2}{*}{Method} & \multicolumn{6}{c|}{$\Delta\rho$ [pcm], ($\Delta L$ [\%])} \\ 
	\cline{3-9}
	&  	 & $I = 5$ & $I = 10$ & $I = 25$ & $I = 50$ & $I = 100$ & $I = 200$ \\ 
	\hline
	\multirow{3}{*}{} & Diffusion & -10,983,(-) & -11,826,(-) & -12,065,(-) & -12,099,(-) & -12,108,(-) & -12,110,(-) \\ 
	\cline{2-9}
	PUa-1-0-SL & CMFD  & -851,(1.257) & -241,(0.353) & -41,(0.062) & -10,(0.016) & -3,(0.005) & 0,(0.002) \\ 
	\cline{2-9}
	& pCMFD & -847,(1.257) & -241,(0.353) & -41,(0.062) & -10,(0.016) & -3,(0.005) & -1,(0.0) \\ 
	\hline
	\multirow{3}{*}{} & Diffusion & -6,309,(-) & -7,239,(-) & -7,503,(-) & -7,541,(-) & -7,550,(-) & -7553,(-) \\ 
	\cline{2-9}
	Ua-1-0-SL & CMFD  & -1,507,(2.286) & -435,(0.644) & -75,(0.109) & -19,(0.027) & -5,(0.006) & -1,(0.0) \\ 
	\cline{2-9}
	& pCMFD & -1,507,(2.286) & -435,(0.644) & -75,(0.109) & -19,(0.027) & -5,(0.006) & -1,(0.0) \\ 
	\hline
	\multirow{2}{*}{} & Diffusion & -15,244,(-) & -15,756,(-) & -15,901,(-) & -15,921,(-) & -15,927,(-) & -15,928,(-)  \\ 
	\cline{2-9}
	PUa-H2O & CMFD  & -319,(0.531) & -86,(0.144) & -15,(0.022) & -8,(0.011) & -3,(0.005) & -1,(0.001) \\ 
	\cline{2-9}
	(0.5)-1-0-SL & pCMFD & -320,(0.531) & -86,(0.142) & -14,(0.022) & -8,(0.011) & -3,(0.005) & -1,(0.001) \\ 
	\hline
\end{tabular}
\end{table}
\vspace{-5.0mm}
\begin{table}[htb]
	\vspace{-5.5mm}
	\centering	
	\caption{\bf Deviations of the normalized flux calculated by the RM from the analytic solution.}
	\label{table:res2} 
	\small
	\begin{tabular}{|c|c|c|c|c|c|} \hline 
	\multirow{2}{*}{Problem ID} & \multirow{2}{*}{Method} & \multicolumn{4}{c|}{$\Delta\phi$ [\%]}  \\
	\cline{3-6}
	& & $L_1 = 0.25$ & $L_2 = 0.5$ & $L_3 = 0.75$ & $L_4 = 1.0$  \\
	\hline
	\multirow{2}{*}{Pub-1-0-SL} & Diffusion  & 0.6392 & 2.8850 & 8.4621 & 31.2535  \\
	\cline{2-6}
	$(I=100)$ & CMFD 	     & 0.0048 & 0.0002 & 0.0039 & 0.8033  \\ \hline
	\multirow{2}{*}{Ua-1-0-SL}  & Diffusion  & 0.5307 & 2.4284 & 7.3924 & 30.7287 \\
	\cline{2-6} 
	$(I=100)$ & CMFD       & 0.0053 & 0.0002 & 0.0096 & 1.4473  \\ \hline 
	\multirow{2}{*}{UD20-1-0-SL} & Diffusion & 1.1404 & 4.1067 & 7.8579 & 35.5854  \\ 
	\cline{2-6} 		
	$(I=200)$& CMFD      & 0.0006 & 0.0030 & 0.0091 & 1.8900  \\ \hline 		
\end{tabular}
\vspace{-5.0mm}
\end{table}

\vspace{-6.5mm}

\section{CONCLUSIONS}

The Ronen method is implemented as an iterative scheme that employs an integral expression for the current to introduce new corrected currents. These corrections are used in a diffusion solver to obtain more accurate solutions. The use of CMFD and pCMFD eliminates the possible division by zero when the flux gradient tends to zero. No significant differences are observed between CMFD and pCMFD in terms of relative error in the criticality of the flux. 

\vspace{-1.5mm}

The preliminary results indicate that the CMFD/pCMFD implementations of the Ronen method achieve high accuracy in this set of problems. The maximal deviation in criticality is $\sim$20 pcm, and the maximal deviation in the spatial distribution of the flux is less than 2\% on the boundary.  
%
The full paper will include a comprehensive benchmark of the Ronen method that will provide a better understanding of its performances, also in terms of numerical stability.

%\section*{NOMENCLATURE}
%If variables are extensively used in the text, a Nomenclature section would be helpful to the readers.

\vspace{-2.5mm}

\section*{ACKNOWLEDGEMENTS}

This research was supported by the Ministry of Energy as part of the scholarship program for undergraduate and graduate students in energy-related fields, contract no. 219-11-045.
% You can enter a bibliography into the document using either BibTex with the bibliography
% style file "mc2021.bst" found in the template directory or using the standard LaTeX
% thebibliography environment.

\vspace{-2.5mm}

\newif\ifusebibtex
%\usebibtexfalse
\usebibtextrue

\ifusebibtex
\setlength{\baselineskip}{12pt}
\bibliographystyle{mc2021}
\bibliography{RM-MC2021}
\else
\setlength{\baselineskip}{12pt}
\begin{thebibliography}{300}
\bibitem{journal} B. Author(s), ``Title,'' \emph{Journal Name in Italic}, 
  \textbf{Volume in Bold}, pp. 34-89 (19xx).
\bibitem{proc_paper} C. D. Author(s), ``Article Title,'' \emph{Proceedings of
  Meeting in Italic}, Location, Dates of Meeting, Vol. n, pp. 134-156 
  (19xx).
\bibitem{book} E. F. Author, \emph{Book Title in Italic}, Publisher, City \&
  Country (19xx). 
\bibitem{website} ``Spallation Neutron Source: The next-generation 
  neutron-scattering facility in the United States,'' 
  \url{http://www.sns.gov/documentation/sns\_brochure.pdf} (2002).
\end{thebibliography}
\fi

%\appendix
%\gdef\thesection{APPENDIX \Alph{section}}
%\section{Sample Appendix 1}
%\label{app:a}
%If necessary, include Appendices numbered in upper case alphabetical order. This is \ref{app:a}. 



\end{document}
